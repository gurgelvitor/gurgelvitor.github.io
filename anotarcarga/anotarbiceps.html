<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Costas - Anotação de Cargas</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="../dashboard.css">
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <a href="anotar-carga.html" class="back-button">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="19" y1="12" x2="5" y2="12"></line>
                    <polyline points="12 19 5 12 12 5"></polyline>
                </svg>
                Voltar
            </a>
            <h1>Exercícios de Bíceps</h1>
            <p>Registre suas cargas e repetições</p>
        </header>

        <main class="main-content">
            <div class="search-container">
                <input type="text" id="exerciseSearch" class="search-input" placeholder="Buscar exercício..." autocomplete="off">
                <div class="suggestions" id="suggestions"></div>
            </div>

            <div class="exercise-list" id="exerciseList">
                <!-- Os exercícios serão adicionados aqui dinamicamente -->
            </div>
        </main>
    </div>

    <script>
        // Banco de dados de exercícios para costas
        const exercisesDB = [
            "Rosca direta polia",
            "Rosca martelo polia",
            "Rosca bayesiana",
            "Rosca 45°",
            "Rosca spider",
            "Rosca scott máquina",
            "Rosca scott com barra W",
            "Rosca scott com halter",
            "Rosca scott unilateral com halter",
            "Rosca direta na polia com pegada pronada",
            "Rosca direta com barra W",
            "Rosca alternada com halter",
            "Rosca martelo alternada com halter"
        ];

        // Elementos do DOM
        const exerciseSearch = document.getElementById('exerciseSearch');
        const suggestions = document.getElementById('suggestions');
        const exerciseList = document.getElementById('exerciseList');
        
        // Carregar exercícios salvos
        let savedExercises = JSON.parse(localStorage.getItem('backExercises')) || [];

        // Exibir exercícios salvos
        function displayExercises() {
            if (savedExercises.length === 0) {
                exerciseList.innerHTML = `
                    <div class="no-exercises">
                        Nenhum exercício adicionado. Busque por um exercício acima.
                    </div>
                `;
                return;
            }

            exerciseList.innerHTML = savedExercises.map((exercise, index) => `
                <div class="exercise-card" data-id="${index}">
                    <div class="exercise-header">
                        <div>
                            <h3 class="exercise-title">${exercise.name}</h3>
                            <div class="exercise-details">
                                <div class="input-group">
                                    <span class="input-label">Peso (kg)</span>
                                    <input type="number" 
                                           value="${exercise.weight || ''}" 
                                           placeholder="0.0" 
                                           class="exercise-input weight-input"
                                           data-id="${index}">
                                </div>
                                <div class="input-group">
                                    <span class="input-label">Repetições</span>
                                    <input type="number" 
                                           value="${exercise.reps || ''}" 
                                           placeholder="0" 
                                           class="exercise-input reps-input"
                                           data-id="${index}">
                                </div>
                            </div>
                        </div>
                        <div class="exercise-actions">
                            <button class="btn btn-delete delete-exercise" data-id="${index}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');

            // Adicionar event listeners para os inputs
            document.querySelectorAll('.weight-input, .reps-input').forEach(input => {
                input.addEventListener('change', function() {
                    const id = parseInt(this.dataset.id);
                    const field = this.classList.contains('weight-input') ? 'weight' : 'reps';
                    savedExercises[id][field] = this.value;
                    saveExercises();
                });
            });

            // Adicionar event listeners para deletar
            document.querySelectorAll('.delete-exercise').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    if (confirm('Tem certeza que deseja remover este exercício?')) {
                        const id = parseInt(e.target.closest('button').dataset.id);
                        savedExercises.splice(id, 1);
                        saveExercises();
                        displayExercises();
                    }
                });
            });
        }

        // Salvar exercícios no localStorage
        function saveExercises() {
            localStorage.setItem('backExercises', JSON.stringify(savedExercises));
        }

        // Buscar exercícios
        exerciseSearch.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            if (searchTerm.length < 2) {
                suggestions.style.display = 'none';
                return;
            }

            const filtered = exercisesDB.filter(ex => 
                ex.toLowerCase().includes(searchTerm) && 
                !savedExercises.some(saved => saved.name === ex)
            );

            if (filtered.length > 0) {
                suggestions.innerHTML = filtered.map(ex => `
                    <div class="suggestion-item" data-name="${ex}">${ex}</div>
                `).join('');
                suggestions.style.display = 'block';
            } else {
                suggestions.style.display = 'none';
            }
        });

        // Adicionar exercício
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('suggestion-item')) {
                const exerciseName = e.target.dataset.name;
                if (!savedExercises.some(ex => ex.name === exerciseName)) {
                    savedExercises.push({
                        name: exerciseName,
                        weight: '',
                        reps: ''
                    });
                    saveExercises();
                    displayExercises();
                }
                exerciseSearch.value = '';
                suggestions.style.display = 'none';
            }
        });

        // Fechar sugestões ao clicar fora
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.search-container')) {
                suggestions.style.display = 'none';
            }
        });

        // Inicializar
        displayExercises();
    </script>
</body>
</html>